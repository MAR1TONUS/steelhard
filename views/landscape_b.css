/* ==========================================================================
   landscape.css
   Auto-formatted for readability: consistent indentation, one declaration per line,
   and non-breaking section comments. No selector/property order was changed.
   ========================================================================== */
:host, .sheet {
  font-family: "Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

.bar {
  cursor: pointer;
  touch-action: none;
}
/* hardening: no selection/drag inside player */

/* === Sheet (sliding panel) === */
:host, .sheet, .sheet * {
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
}
img {
  -webkit-user-drag:none;
}

/* time font */
.time {
  display:flex;
  justify-content:space-between;
  color:#BEBEBE;
  font-family:"Montserrat",system-ui,-apple-system,Segoe UI,Roboto,Arial;
  font-weight:600;
  font-size:12px;
  margin-top:6px;
}

/* progress knob */
:host {
  --knob-size: 12px;
  --btn-play-w: clamp(61px,7vw,73px);
  --btn-play-h: clamp(61px,7vw,73px);
  --play-bump: 2px;
}

.bar {
  position:relative;
}

.knob {
  position:absolute;
  top:50%;
  left:0%;
  width:var(--knob-size);
  height:var(--knob-size);
  border-radius:50%;
  transform: translate(-50%, -50%);
  background:#fff;
  box-shadow:none;
  opacity:.95;
  pointer-events:none;
}

.bar {
  cursor: pointer;
  touch-action: none;
}

/* bump animation */
.btn.play {
  width: var(--btn-play-w);
  height: var(--btn-play-h);
}

.btn.play img.bump {
  transform: scale(1.03);
}

.btn.play img {
  width:100%;
  height:100%;
  display:block;
  object-fit:contain;
  transition: transform .12s ease;
  will-change: transform;
}

:host {
  --sheet-max-w: 700px;
  --sheet-radius-top: 18px;
  --sheet-radius-current: var(--sheet-radius-top);
  --cover-shadow-x: 0px;
  --cover-shadow-y: 0px;
  --cover-shadow-blur: 20px;
  --cover-shadow-spread: 0px;
  --cover-shadow-color: rgba(0,0,0,.42);
}

:host, * {
  box-sizing: border-box;
}

.overlay {
  position: fixed;
  inset: 0;
  display: grid;
  align-content: end;
  justify-items: center;
  background-color: transparent;
  pointer-events: none;
  z-index: 999999;
  transition: background-color 160ms linear;
}

.overlay.open {
  background-color: transparent;
  pointer-events: auto;
}

.sheet {
  width: 100vw;
  height: 100dvh;
  box-sizing: border-box;
  background: #ff0000;
  color: #F3F2F7;
  border-radius: 0 0 0 0;
  box-shadow: 0 1px 60px rgba(0,0,0,.6), 0 1px 0 rgba(255,255,255,.04) inset;
  overflow:hidden;
  padding: clamp(16px,3.2vw,36px) clamp(16px,3.2vw,40px) calc(clamp(16px,3.2vw,40px) + env(safe-area-inset-bottom));
  display: flex;
  flex-direction: column;
  gap: clamp(12px,2.2vw,20px);
  touch-action: none;
  will-change: transform, border-radius;
}

.cover {
  height: clamp(290px, 32vw, 390px);
  display:grid;
  place-items:center;
  margin-top: clamp(24px,8vh,120px);
}

.img {
  width: clamp(282px, 32vw, 382px);
  height: clamp(282px, 32vw, 382px);
  background:#C4C4C4 center/cover no-repeat;
  border-radius: clamp(10px,1.4vw,16px);
  box-shadow: var(--cover-shadow-x) var(--cover-shadow-y) var(--cover-shadow-blur) var(--cover-shadow-spread) var(--cover-shadow-color);
  overflow:hidden;
}

.meta {
  text-align: center;
}

.title {
  overflow:hidden;
  position:relative;
  font: 780 clamp(18px,2.4vw,28px)/1.12 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:#C4C4C4;
  height:1.25em;
  white-space:nowrap;
  overflow:hidden;
  -webkit-mask-image:linear-gradient(to right, transparent 0%, #000 9%, #000 91%, transparent 100%);
  mask-image:linear-gradient(to right, transparent 0%, #000 9%, #000 91%, transparent 100%);
}

/* === Title === */
.title .track {
  display:inline-flex;
  gap:24px;
  will-change: transform;
}

.title.marquee .track {
  animation: marquee var(--dur, 14s) linear infinite !important;
}

@keyframes marquee {
  from {
    transform: translateX(0)
  }
  to {
    transform: translateX(calc(-1 * var(--dist, 0px)))
  }
}

.author {
  color:#B4B4B4;
  font: 700 clamp(14px,1.8vw,18px)/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
}

.progress-wrap {
  width:min(100%, clamp(320px, 60vw, 475px));
  margin: 0 auto;
}

.bar {
  height:5px;
  background:rgba(255,255,255,.14);
  border-radius:999px;
  position:relative;
}

.fill {
  height:100%;
  width:0%;
  background:#fff;
  border-radius:999px;
}

.time {
  display:flex;
  justify-content:space-between;
  color:#BEBEBE;
  font: 600 12px;
  margin-top:6px;
}

.controls {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  top: 0;
  transform: translateY(var(--controls-dy));
}

.btn {
  all: unset;
  width: clamp(39px,6vw,48px);
  height: clamp(39px,6vw,48px);
  border-radius: 999px;
  display:grid;
  place-items:center;
  cursor:pointer;
}

.btn.play {
  width: clamp(61px,7vw,73px);
  height: clamp(61px,7vw,73px);
}

/* === AFF lock: when an overlay is over the track, block interactions === */
.track.is-locked {
  cursor: not-allowed;
}

.track.is-locked .track-left, .track.is-locked .track-time {
  opacity:.95;
}

/* === Disable text selection globally (with safe exceptions) === */
html, body, .page {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  /* iOS long-press menu */
}

/* Re-enable selection where it should be allowed */
input, textarea, [contenteditable="true"], .allow-select {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
  -webkit-touch-callout: default;
}

/* === ICON SIZE VARIABLES + SCOPED OVERRIDES (final) === */
:root {
  --size-prev: 30px;
  --size-back15: 35px;
  --size-play: 60px;
  --size-fwd30: 35px;
  --size-next: 30px;
}

/* === Controls (buttons) === */
.controls img {
  display:block;
  margin:auto;
  max-width:none;
  max-height:none;
}
#prev img {
  width: var(--size-prev) !important;
  height: var(--size-prev) !important;
}
#back15 img {
  width: var(--size-back15)!important;
  height: var(--size-back15)!important;
}
#pp img {
  width: var(--size-play) !important;
  height: var(--size-play) !important;
}
#fwd30 img {
  width: var(--size-fwd30) !important;
  height: var(--size-fwd30) !important;
}
#next img {
  width: var(--size-next) !important;
  height: var(--size-next) !important;
}
/* Применяем единым местом */

/* === Controls gap (single variable, shadow DOM override) === */
:host {
  --controls-gap: clamp(16px, 3vw, 48px);
}

/* === Inner controls container layout (pure gap control) === */
#controls.controls {
  display: inline-flex;
  align-items: center;
  justify-content: center !important;
  /* не раздвигаем пространство */
  gap: var(--controls-gap) !important;
  /* управляем только gap */
  width: auto;
  /* ширина по содержимому */
  margin: 0 auto;
  /* центрируем ряд */
}

/* === Movable sections (axis-based) === */
:host {
  --axis: 0px;
  --head-dy: 20px;
  --title-dy: 150px;
  --controls-dy: 83px;
  --chapter-dy: 185px;
  --progress-dy: 205px;
}
/* make .meta's children participate as siblings */
.meta {
  display: contents;
}
/* enforce order & individual vertical offsets */
.cover {
  order:10;
  position:relative;
  top: calc(var(--axis) + var(--head-dy));
}
.title {
  order:20;
  position:relative;
  top: calc(var(--axis) + var(--title-dy));
}
.controls {
  order:30;
  position:relative;
  top: calc(var(--axis) + var(--controls-dy));
}
.author {
  order:40;
  position:relative;
  top: calc(var(--axis) + var(--chapter-dy));
}
.progress-wrap {
  order:50;
  position:relative;
  top: calc(var(--axis) + var(--progress-dy));
}

/* Состояния шторки: закрыто/открыто — надёжно через класс .open на overlay */
.overlay:not(.open) .sheet {
  transform: translateY(100%);
}

.overlay.open .sheet {
  transform: translateY(0%);
  /* Фолбэки на случай отсутствия переменных */
  transition: transform var(--sheet-open-dur, 260ms) var(--sheet-ease, cubic-bezier(.2,.7,0,1));
  will-change: transform;
}

/* Надёжная высота на мобильных */
.sheet {
  height: 100vh;
  height: 100dvh;
}

/* Определим переменные, если их нет */
:host {
  --sheet-open-dur: 260ms;
  --sheet-close-dur: 220ms;
  --sheet-ease: cubic-bezier(.2, .7, 0, 1);
}

/* (Опционально) уважим reduce-motion: мгновенно, но без «телепорта» */
@media (prefers-reduced-motion: reduce) {
  .overlay.open .sheet { transition-duration: 0ms; }
}
