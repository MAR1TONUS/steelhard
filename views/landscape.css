/* views/landscape.css — горизонтальный вариант
   Нулевое состояние: все элементы стоят РОВНО в центре .sheet.
   Перемещения ТОЛЬКО пикселями. Прогресс/контролы — по оси Y.
*/

/* ===================== ПЕРЕМЕННЫЕ ===================== */
:host{
  /* фон/анимация */
  --bg:#483B50;
  --sheet-open-dur:420ms;
  --sheet-ease:cubic-bezier(.2,.7,0,1);

  /* контейнер: видимый край при перетягивании */
  --sheet-radius: 0px;                 /* ты писал, что скругление не нужно */
  --sheet-shadow: 0 16px 40px rgba(0,0,0,.35);

  /* база */
  --gap:16px;

  /* ОБЛОЖКА */
  --cover-size:132px;
  --cover-radius:clamp(8px, 1.6vw, 9px);
  --cover-shadow-x:0px;
  --cover-shadow-y:0px;
  --cover-shadow-blur:22px;
  --cover-shadow-spread:0px;
  --cover-shadow-color:rgba(0,0,0,.42);
  --cover-x:-300px;
  --cover-y:-65px;

  /* ТЕКСТОВЫЙ БЛОК (общий сдвиг для title+part) */
  --meta-x:45px;                        
  --meta-y:-35px;
  --meta-gap: 3px;                        

  /* НАЗВАНИЕ */
  --title-size:18px;
  --title-width: clamp(310px, 70vw, 520px);
  --title-color:#E6E1EA;
  --title-weight:780;

  /* ГЛАВА */
  --part-size:14;
  --part-weight:600;
  --part-color:#b6b6b6;

  /* КОНТРОЛЫ (контейнер кнопок) — только по Y */
  --controls-gap:clamp(55px, 3vw, 60px);
  --controls-y:110px;

  /* размеры отдельных кнопок */
  --size-prev:30px;
  --size-back15:36px;
  --size-play:60px;
  --size-fwd30:36px;
  --size-next:30px;

  /* ПРОГРЕСС — только по Y */
  --progress-width:clamp(750px, 60vw, 800px);
  --progress-height:5px;
  --progress-knob:12px;
  --progress-track:rgba(255,255,255,.18);
  --progress-fill:#FFFFFF;
  --progress-y:40px;

  --time-size: 12px; 
  --time-weight: 500;
  --time-color: rgb(177 177 177); 

  /* Бегущая строка (speed-mode) */
  --marquee-speed:16;  /* px/s */
  --marquee-min:8s;
  --marquee-max:50s;
}

/* ===================== БАЗА/КОНТЕЙНЕР ===================== */
:host{ background: transparent; }

.overlay{
  position:fixed; inset:0; z-index:2147483000;
  display:flex; align-items:center; justify-content:center;
  background: transparent;
  overscroll-behavior: contain;
  touch-action: none;
  opacity:0; visibility:hidden;
  transition: opacity 200ms var(--sheet-ease), visibility 0s linear 200ms;
}
.overlay.open{
  opacity:1; visibility:visible;
  transition: opacity 200ms var(--sheet-ease);
}

/* ШТОРКА на весь экран — видно край при перетягивании */
.sheet{
  position:relative;
  width:100vw;
  height: calc(var(--vh, 1vh) * 100);
  padding:
    calc(clamp(12px, 3vh, 40px) + env(safe-area-inset-top, 0px))
    calc(clamp(12px, 3vw, 40px) + env(safe-area-inset-right, 0px))
    calc(clamp(12px, 3vh, 40px) + env(safe-area-inset-bottom, 0px))
    calc(clamp(12px, 3vw, 40px) + env(safe-area-inset-left, 0px));
  box-sizing:border-box;
  background:var(--bg);
  border-radius:var(--sheet-radius);
  box-shadow:var(--sheet-shadow);
  transform:translateY(100%);
}

.overlay.open .sheet{
  transition: transform var(--sheet-open-dur) var(--sheet-ease);
  transform: translateY(0);
}

/* Все блоки позиционируем из центра .sheet */
.cover, .meta, .progress-wrap, .controls{
  position:absolute; left:50%; top:50%;
  transform-origin:50% 50%;
}

/* ===================== ОБЛОЖКА ===================== */
.cover{
  transform: translate(-50%, -50%) translate(var(--cover-x), var(--cover-y));
}
.cover .img{
  width:var(--cover-size); height:var(--cover-size);
  border-radius:var(--cover-radius);
  background-size:cover; background-position:center;
  box-shadow: var(--cover-shadow-x) var(--cover-shadow-y) var(--cover-shadow-blur) var(--cover-shadow-spread) var(--cover-shadow-color);
  filter:saturate(.98) contrast(.98);
}

/* ===================== ТЕКСТ (общий блок) ===================== */
.meta{
  transform: translate(-50%, -50%) translate(var(--meta-x), var(--meta-y));
  text-align: left;

  /* новое: управляем расстоянием между строками через gap */
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: var(--meta-gap, 8px);
}

/* Заголовок с marquee */
.title{
  width:var(--title-width);
  white-space:nowrap; overflow:hidden;
  height:1.25em; line-height:1.2;
  color:var(--title-color);
  font-weight:var(--title-weight);
  font-size:var(--title-size);
  margin: 0;
  padding: 0;
}

.title.is-clip{
  -webkit-mask-image: linear-gradient(to right, transparent 0%, #000 8%, #000 92%, transparent 100%);
          mask-image: linear-gradient(to right, transparent 0%, #000 8%, #000 92%, transparent 100%);
}
.title .track{
  display:inline-flex; gap:24px; will-change:transform;
  font:inherit; color:inherit;
}
.title.marquee .track{ animation: marquee-loop var(--dur,14s) linear infinite; }
@keyframes marquee-loop{
  from{ transform: translateX(0); }
  to  { transform: translateX(calc(-1 * var(--dist, 0px))); }
}

/* Глава (вторая строка) */
.part{
  margin: 0;
  color: var(--part-color);
  font-weight: var(--part-weight);
  font-size: var(--part-size);
}


/* ===================== ПРОГРЕСС (только Y и ширина) ===================== */
.progress-wrap{
  width:var(--progress-width) !important; /* фиксируем применение переменной */
  transform: translate(-50%, -50%) translateY(var(--progress-y));
}
.progress-wrap .bar{
  position:relative;
  height:var(--progress-height);
  border-radius:999px;
  background:var(--progress-track);
}
.progress-wrap .fill{
  position:absolute; left:0; top:0; bottom:0;
  width:0%;
  background:var(--progress-fill);
  border-radius:999px;
}
.progress-wrap .knob{
  position:absolute; top:50%; transform: translate(-50%, -50%);
  left:0%;
  width:var(--progress-knob); height:var(--progress-knob);
  border-radius:50%;
  background:#fff;
  box-shadow:0 1px 4px rgba(0,0,0,.35);
}

.progress-wrap .time {
  display:flex;
  justify-content:space-between;
  margin-top: clamp(6px, .8vh, 10px);

  font-size: var(--time-size);
  font-weight: var(--time-weight);
  color: var(--time-color);
}


/* ===================== КОНТРОЛЫ (только Y) ===================== */
.controls{
  transform: translate(-50%, -50%) translateY(var(--controls-y));
  display:flex; align-items:center; justify-content:center;
  gap:var(--controls-gap);
  line-height: 0; /* без влияния межстрочного интервала */
}
.controls .btn{
  appearance:none; border:0; outline:0; background:transparent; padding:0; cursor:pointer;
  display:flex; align-items:center; justify-content:center; /* строгая центровка */
  vertical-align: middle;
}

.controls .btn img {
  display: block;
  width: 100%;
  height: 100%;
  transform-origin: 50% 50%;
}


/* индивидуальные размеры (по центру строки контролов) */
.controls #prev   { width:var(--size-prev);   height:var(--size-prev); }
.controls #back15 { width:var(--size-back15); height:var(--size-back15); }
.controls #pp     { width:var(--size-play);   height:var(--size-play); }
.controls #fwd30  { width:var(--size-fwd30);  height:var(--size-fwd30); }
.controls #next   { width:var(--size-next);   height:var(--size-next); }

/* бамп на иконке */
.controls .btn img.bump{ animation: pp-bump 140ms ease-out; }
@keyframes pp-bump{ 0%{transform:scale(1)} 50%{transform:scale(1.07)} 100%{transform:scale(1)} }

/* гарантия кликабельности на десктопе */
.controls, .controls * { pointer-events:auto; }

/* ===================== REDUCED MOTION ===================== */
@media (prefers-reduced-motion: reduce){
  .overlay.open .sheet{ transition:none; }
  .title.marquee .track{ animation:none; }
  .controls .btn img.bump{ animation:none; }
}

/* фиксация ширины прогресса: жёстко и с максимальной специфичностью внутри шэдоу */
:host .sheet .progress-wrap{
  width: var(--progress-width) !important;
  min-width: var(--progress-width) !important;
  max-width: var(--progress-width) !important;
}
